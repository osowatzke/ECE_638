\documentclass[fleqn]{article}
\usepackage[nodisplayskipstretch]{setspace}
\usepackage{amsmath, nccmath, bm}
\usepackage{amssymb}
\usepackage{enumitem}

\newcommand{\zerodisplayskip}{
	\setlength{\abovedisplayskip}{0pt}%
	\setlength{\belowdisplayskip}{0pt}%
	\setlength{\abovedisplayshortskip}{0pt}%
	\setlength{\belowdisplayshortskip}{0pt}%
	\setlength{\mathindent}{0pt}}
	
\newcommand{\norm}[1]{\left \lVert #1 \right \rVert}

\makeatletter
	\newenvironment{equationCenter}{\@fleqnfalse\begin{equation*}}{\end{equation*}}
\makeatother

\title{Exam 2}
\author{Owen Sowatzke}
\date{November 12, 2024}

\begin{document}

	\offinterlineskip
	\setlength{\lineskip}{12pt}
	\zerodisplayskip
	\maketitle
	
	\begin{enumerate}
		\item[3.] Let us now consider the time-invariant frequency-selective block-fading channel with 32 subchannels of bandwidth 2 MHz, with frequency response amplitudes being $1$ for odd subchannels and $\sqrt{2}$ for even subchannels, respectively. For the transmit power 10 mW and noise power-spectral density of $N_0=10^{-9}$ W/Hz determine the OFDM channel capacity. What is corresponding optimum power allocation strategy based on OFDM to achieve this channel capacity? Provide the corresponding OFDM transmitter and receiver configurations.
		
		\item[5.] The space-time code for number of transmit antennas $M_{TX}=4$, number of receive antennas $M_{RX}=1$, and number of channel's uses $N=4$ is described by the following signaling matrix:
		
		\begin{equationCenter}
			\mathbf{X} = \begin{bmatrix}
				x_1 & -x_2^* & -x_3^* &  0 \\ 
				x_2 &  x_1^* &  0     &  x_3^* \\
				x_3 &  0     &  x_1^* & -x_2^* \\
				0   & -x_3^* &  x_2^* &  x_1^*
			\end{bmatrix}
		\end{equationCenter}
		
		\begin{enumerate}
			\item Can this space-time block code be used to design the receiver that will result in spatial interference cancellation? If so describe the corresponding receiver configuration. What is the code rate of this space-time code?
			
			\begin{equation*}
				\mathbf{Y} = \mathbf{H}\mathbf{X} + \mathbf{Z}
			\end{equation*}
			
			\begin{equation*}
				\begin{bmatrix}
					y_1 \\ y_2 \\ y_3 \\ y_4
				\end{bmatrix} = \begin{bmatrix}
					h_1 & h_2 & h_3 & h_4
				\end{bmatrix}\begin{bmatrix}
					x_1 & -x_2^* & -x_3^* &  0 \\ 
					x_2 &  x_1^* &  0     &  x_3^* \\
					x_3 &  0     &  x_1^* & -x_2^* \\
					0   & -x_3^* &  x_2^* &  x_1^*
				\end{bmatrix} + \begin{bmatrix}
					z_1 \\ z_2 \\ z_3 \\ z_4
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				\begin{bmatrix}
					y_1 \\ y_2 \\ y_3 \\ y_4
				\end{bmatrix} = \begin{bmatrix}
					 h_1x_1   + h_2x_2   + h_3x_3 \\
					-h_1x_2^* + h_2x_1^* - h_4x_3^* \\
					-h_1x_3^* + h_3x_1^* + h_4x_2^* \\
					 h_2x_3^* - h_3x_2^* + h_4x_1^*
				\end{bmatrix} + \begin{bmatrix}
					z_1 \\ z_2 \\ z_3 \\ z_4
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				\begin{bmatrix}
					y_1 \\ y_2^* \\ y_3^* \\ y_4^*
				\end{bmatrix} = \begin{bmatrix}
					 h_1x_1   + h_2x_2   + h_3x_3 \\
					-h_1^*x_2 + h_2^*x_1 - h_4^*x_3 \\
					-h_1^*x_3 + h_3^*x_1 + h_4^*x_2 \\
					 h_2^*x_3 - h_3^*x_2 + h_4^*x_1
				\end{bmatrix} + \begin{bmatrix}
					z_1 \\ z_2^* \\ z_3^* \\ z_4^*
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				\begin{bmatrix}
					y_1 \\ y_2^* \\ y_3^* \\ y_4^*
				\end{bmatrix} = \begin{bmatrix}
					h_1   &  h_2   &  h_3 \\
				    h_2^* & -h_1^* & -h_4^* \\
					h_3^* &  h_4^* & -h_1^* \\
					h_4^* & -h_3^* &  h_2^*
				\end{bmatrix} \begin{bmatrix}
					x_1 \\ x_2 \\ x_3
				\end{bmatrix} + \begin{bmatrix}
					z_1 \\ z_2^* \\ z_3^* \\ z_4^*
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				\mathbf{\tilde{Y}} = \mathbf{\tilde{H}x} + \mathbf{\tilde{z}}
			\end{equation*}
			
			\begin{equation*}
				\mathbf{\tilde{H}^\dagger\tilde{Y}} = \mathbf{\tilde{H}^\dagger\tilde{H}x} + \mathbf{\tilde{H}^\dagger\tilde{z}}
			\end{equation*}
			
			\begin{equation*}
				\mathbf{\tilde{H}^\dagger\tilde{H}} = \begin{bmatrix}
					h_1^* &  h_2 &  h_3 &  h_4 \\
					h_2^* & -h_1 &  h_4 & -h_3 \\
					h_3^* & -h_4 & -h_1 &  h_2
				\end{bmatrix} \begin{bmatrix}
					h_1   &  h_2   &  h_3 \\
				    h_2^* & -h_1^* & -h_4^* \\
					h_3^* &  h_4^* & -h_1^* \\
					h_4^* & -h_3^* &  h_2^*
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				= \begin{bmatrix}
					|h_1|^2 + \cdots + |h_4|^2 & h_3h_4^* - h_3^*h_4 & h_2^*h_4 - h_2h_4^* \\
					h_3^*h_4 - h_3h_4^* & |h_1|^2 + \cdots + |h_4|^2 & h_1h_4^* - h_1^*h_4 \\
					h_2h_4^* - h_2^*h_4 & h_1^*h_4 - h_1h_4^* & |h_1|^2 + \cdots + |h_4|^2
				\end{bmatrix}
			\end{equation*}
			
			Note that there are multiple terms of the form:
			
			\begin{equation*}
				a - a^* = \text{Re}\{a\} + j\text{Im}\{a\} - (\text{Re}\{a\} - j\text{Im}\{a\}) = j2\text{Im}\{a\}
			\end{equation*}
			
			For the space-time block code to result in spatial interference cancellation, we must be able to write $\mathbf{\tilde{H}^{\dagger}\tilde{H}}$ as $\alpha\mathbf{I}$.
			
			Note that this is not the case in general for the code provided, so it does \textbf{\underline{not}} result in spatial interference cancellation.
			
			However, in a real orthogonal design, the matrix $\mathbf{\tilde{H}}$ is real. This results in $\mathbf{\tilde{H}^\dagger\tilde{H}} = (|h_1|^2 + \cdots + |h_4|^2)\mathbf{I}$. In other words, spatial interference cancellation is realized.
			
			In this case, the coding rate would be $3/4$, because 3 symbols are transmitted in 4 symbol intervals.
			
			\pagebreak
			\item Represent the signaling matrix $\mathbf{X}$ in the same fashion as for linear space-time (LST) codes. If the channel matrix is given by $\mathbf{H}=\begin{bmatrix} h_1 & h_2 & h_3 & h_4 \end{bmatrix}$ using detection approach for LST determine the equations for the estimated symbols $\hat{x}_i$.
			
			Let $x_1 = a_1 + jb_1$, $x_2 = a_2 + jb_2$, and $x_3 = a_3 + jb_3$.
			
			\begin{equation*}
				\mathbf{X} = a_1\mathbf{A_1} + jb_1\mathbf{B_1} + \cdots + a_3\mathbf{A_3} + jb_3\mathbf{B_3}
			\end{equation*}
			
			\begin{equation*}
				= a_1\begin{bmatrix}
					1 & 0 & 0 & 0 \\
					0 & 1 & 0 & 0 \\
					0 & 0 & 1 & 0 \\
					0 & 0 & 0 & 1
				\end{bmatrix} + jb_1\begin{bmatrix}
					1 &  0 &  0 &  0 \\
					0 & -1 &  0 &  0 \\
					0 &  0 & -1 &  0 \\
					0 &  0 &  0 & -1
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				 + a_2\begin{bmatrix}
					0 & -1 & 0 &  0 \\
					1 &  0 & 0 &  0 \\
					0 &  0 & 0 & -1 \\
					0 &  0 & 1 &  0
				\end{bmatrix} + jb_2\begin{bmatrix}
					0 & 1 &  0 & 0 \\
					1 & 0 &  0 & 0 \\
					0 & 0 &  0 & 1 \\
					0 & 0 & -1 & 0
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				+ a_3\begin{bmatrix}
					0 &  0 & -1 & 0 \\
					0 &  0 &  0 & 1 \\
					1 &  0 &  0 & 0 \\
					0 & -1 &  0 & 0
				\end{bmatrix} + jb_3\begin{bmatrix}
					0 & 0 & 1 &  0 \\
					0 & 0 & 0 & -1 \\
					1 & 0 & 0 &  0 \\
					0 & 1 & 0 &  0
				\end{bmatrix}
			\end{equation*}
			
			We can define define the transmitted vector as follows:
			
			\begin{equation*}
				\mathbf{\tilde{x}} = \begin{bmatrix}
					a_1 & b_1 & \cdots & a_3 & b_3
				\end{bmatrix}^T
			\end{equation*}
			
			We can also define the noise vector as $\mathbf{\tilde{z}} = \text{vec}(\mathbf{Z})$ and the received vector as $\mathbf{\tilde{y}} = \text{vec}(\mathbf{Y})$.
			
			Next, if we define the modified channel matrix as
			
			\begin{equation*}
				\mathbf{\tilde{H}} = \begin{bmatrix}
					\text{vec}(\mathbf{HA_1}) & \text{vec}(j\mathbf{HB_1}) & \cdots & \text{vec}(\mathbf{HA_3}) & \text{vec}(j\mathbf{HB_3})
				\end{bmatrix}
			\end{equation*} 
			
			\begin{equation*}
				\mathbf{HA_1} = \begin{bmatrix}
					h_1 & h_2 & h_3 & h_4
				\end{bmatrix}\begin{bmatrix}
					1 & 0 & 0 & 0 \\
					0 & 1 & 0 & 0 \\
					0 & 0 & 1 & 0 \\
					0 & 0 & 0 & 1
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				= \begin{bmatrix}
					h_1 & h_2 & h_3 & h_4
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				\mathbf{HB_1} = \begin{bmatrix}
					h_1 & h_2 & h_3 & h_4
				\end{bmatrix}\begin{bmatrix}
					1 &  0 &  0 &  0 \\
					0 & -1 &  0 &  0 \\
					0 &  0 & -1 &  0 \\
					0 &  0 &  0 & -1
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				 = \begin{bmatrix}
					h_1 & -h_2 & -h_3 & -h_4
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				\mathbf{HA_2} = \begin{bmatrix}
					h_1 & h_2 & h_3 & h_4
				\end{bmatrix}\begin{bmatrix}
					0 & -1 & 0 &  0 \\
					1 &  0 & 0 &  0 \\
					0 &  0 & 0 & -1 \\
					0 &  0 & 1 &  0
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				= \begin{bmatrix}
					h_2 & -h_1 & h_4 & -h_3
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				\mathbf{HB_2} = \begin{bmatrix}
					h_1 & h_2 & h_3 & h_4
				\end{bmatrix}\begin{bmatrix}
					0 & 1 &  0 & 0 \\
					1 & 0 &  0 & 0 \\
					0 & 0 &  0 & 1 \\
					0 & 0 & -1 & 0
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				= \begin{bmatrix}
					h_2 & h_1 & -h_4 & h_3
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				\mathbf{HA_3} = \begin{bmatrix}
					h_1 & h_2 & h_3 & h_4
				\end{bmatrix}\begin{bmatrix}
					0 &  0 & -1 & 0 \\
					0 &  0 &  0 & 1 \\
					1 &  0 &  0 & 0 \\
					0 & -1 &  0 & 0
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				= \begin{bmatrix}
					h_3 & -h_4 & -h_1 & h_2
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				\mathbf{HB_3} = \begin{bmatrix}
					h_1 & h_2 & h_3 & h_4
				\end{bmatrix}\begin{bmatrix}
					0 & 0 & 1 &  0 \\
					0 & 0 & 0 & -1 \\
					1 & 0 & 0 &  0 \\
					0 & 1 & 0 &  0
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				= \begin{bmatrix}
					h_3 & h_4 & h_1 & -h_2
				\end{bmatrix}
			\end{equation*}
			
			\begin{equation*}
				\Rightarrow \mathbf{\tilde{H}} = \begin{bmatrix}
					h_1 &  jh_1 &  h_2 &  jh_2 &  h_3 &  jh_3 \\
					h_2 & -jh_2 & -h_1 &  jh_1 & -h_4 &  jh_4 \\
					h_3 & -jh_3 &  h_4 & -jh_4 & -h_1 &  jh_1 \\
					h_4 & -jh_4 & -h_3 &  jh_3 &  h_2 & -jh_2
				\end{bmatrix}
			\end{equation*}
			
			We can then use QR decomposition to write $\mathbf{\tilde{H}}$ as follows:
			
			\begin{equation*}
				\mathbf{\tilde{H}} = \mathbf{\tilde{Q}}\mathbf{\tilde{R}}
			\end{equation*}
		\end{enumerate}
		
		where $\mathbf{\tilde{Q}}$ is a unitary matrix and $\mathbf{\tilde{R}}$ is an upper triangular matrix.
		
		Next, we can express the received vector $\mathbf{\tilde{y}}$ as follows:
		
		\begin{equation*}
			\mathbf{\tilde{y}} = \mathbf{\tilde{H}\tilde{x}} + \mathbf{\tilde{z}} = \mathbf{\tilde{Q}\tilde{R}\tilde{x}} + \mathbf{\tilde{z}}
		\end{equation*}
		
		\begin{equation*}
			\Rightarrow \mathbf{\tilde{Q}^{\dagger}\tilde{y}} = \mathbf{\tilde{R}\tilde{x}} + \mathbf{\tilde{Q}^{\dagger}\tilde{z}}
		\end{equation*}
		
		We can find $\mathbf{\tilde{x}}$ by minimizing the error between $\mathbf{\tilde{R}\tilde{x}}$ and $\mathbf{\tilde{Q}^{\dagger}\tilde{y}}$.
		
		\begin{equation*}
			\mathbf{\hat{x}} = \underset{\mathbf{\tilde{x}}}{\text{arg min}}{\norm{\mathbf{\tilde{Q}^{\dagger}\tilde{y}} - \tilde{R}\tilde{x}}_F}
		\end{equation*}
		
		Finally, we can get $\hat{x}_i$ from $\mathbf{\hat{x}}$ as follows:
		
		\begin{equation*}
			\mathbf{\hat{x}} = \begin{bmatrix}\text{Re}(\hat{x}_1) & \text{Im}(\hat{x}_1) & \cdots & \text{Re}(\hat{x}_3) & \text{Im}(\hat{x}_3)\end{bmatrix}^T
		\end{equation*}
		
		
	\end{enumerate}
\end{document}